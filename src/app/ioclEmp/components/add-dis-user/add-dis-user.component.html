<!-- <p>add-dis-user works!</p> -->
<mat-card class="small-card">
    <div class="profile-photo-container">
      <img src="assets/profile.webp" alt="Profile Image" class="profile-image">
    </div>
    <mat-card-content>
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        
        <!-- Loc Code -->
        <!-- <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Loc Code</mat-label>
            <input matInput formControlName="locCode" [matAutocomplete]="autoLocCode" placeholder="Enter Loc Code">
            <mat-autocomplete #autoLocCode="matAutocomplete">
              <mat-option *ngFor="let locCode of filteredLocationCodes | async" [value]="locCode">
                {{ locCode }}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="userForm.get('locCode')?.invalid && userForm.get('locCode')?.touched">
              Loc Code is required
            </mat-error>
          </mat-form-field>
        </div> -->
  
        <!-- User ID -->
        <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>User ID</mat-label>
            <input matInput formControlName="userId" [matAutocomplete]="autoUserId" placeholder="Enter User ID">
            <mat-autocomplete #autoUserId="matAutocomplete">
              <mat-option *ngFor="let id of filteredEmployeeCodes | async" [value]="id">
                {{ id }}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="userForm.get('userId')?.invalid && userForm.get('userId')?.touched">
              User ID is required
            </mat-error>
          </mat-form-field>
        </div>
  
        <!-- User Name -->
        <!-- <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>User Name</mat-label>
            <input matInput formControlName="userName" [matAutocomplete]="autoUserName" placeholder="Enter User Name">
            <mat-autocomplete #autoUserName="matAutocomplete">
              <mat-option *ngFor="let name of filteredUserNames | async" [value]="name">
                {{ name }}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="userForm.get('userName')?.invalid && userForm.get('userName')?.touched">
              User Name is required
            </mat-error>
            <mat-hint *ngIf="!empNames.length">Please enter a valid loc code to load usernames.</mat-hint>
          </mat-form-field>
        </div> -->

        <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>User Name</mat-label>
            <input matInput formControlName="userName" placeholder="Enter userName"   [(ngModel)]="empName">
          </mat-form-field>
        </div>
  
        <!-- Mobile Number -->
        <!-- <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Mobile Number</mat-label>
            <input matInput formControlName="mobileNumber" placeholder="Enter Mobile Number">
          </mat-form-field>
        </div> -->

        <!-- <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Mobile Number</mat-label>
            <input matInput formControlName="mobileNumber" placeholder="Enter Mobile Number" required>
            <mat-error *ngIf="userForm.get('mobileNumber')?.hasError('mobileNumberExists')">
              Mobile number already exists. Please use a different number.
            </mat-error>
          </mat-form-field>
        </div> -->
        <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Mobile Number</mat-label>
            <input 
              matInput 
              formControlName="mobileNumber" 
              placeholder="Enter Mobile Number" 
              required 
              maxlength="10" 
              (input)="onInput($event)" 
            />
        
            <!-- Display error message for mobile number existence -->
            <mat-error *ngIf="userForm.get('mobileNumber')?.hasError('mobileNumberExists')">
              Mobile number already exists. Please use a different number.
            </mat-error>
            <mat-error *ngIf="userForm.get('mobileNumber')?.hasError('minlength')">
              Mobile number must be exactly 10 digits.
            </mat-error>
            <!-- Display error message for invalid mobile number (non-numeric or not 10 digits) -->
            <mat-error *ngIf="userForm.get('mobileNumber')?.hasError('pattern')">
              Mobile number must be exactly 10 digits and numeric.
            </mat-error>
          </mat-form-field>
        </div>
        
        
        
        

        <!-- <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Password</mat-label>
            <input matInput formControlName="password" placeholder="Set password For Dispatch Employee">
          </mat-form-field>
        </div> -->

        <mat-form-field appearance="fill">
          <!-- <mat-label>Password</mat-label>
          <input matInput formControlName="password" placeholder="Set password For Dispatch Employee"> -->
          <mat-label>Password</mat-label>
          <input matInput [type]="hide ? 'password' : 'text'" formControlName="password" placeholder="Set password For Dispatch Employee">
          <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
            <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
        </mat-form-field>
        <!-- Role ID -->
        <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Role ID</mat-label>
            <mat-select formControlName="roleId" placeholder="Enter Role ID">
              <mat-option *ngFor="let role of empRoles" [value]="role">
                {{ role }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
  
        <!-- Submit Button -->
        <div class="add-button-container">
          <button mat-raised-button color="primary" type="submit">Add</button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
